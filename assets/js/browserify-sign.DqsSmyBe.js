import{r as Me}from"./safe-buffer.DM0JMpYF.js";import{r as ir}from"./create-hash.DW7O4rXN.js";import{r as nr,p as ne}from"./vite-plugin-node-polyfills.B4DYk75w.js";import{c as ae}from"./asn1.js.CF-FLH_W.js";import{r as fe}from"./process-nextick-args.DSuUL0kd.js";import{r as ar}from"./isarray.aIBLcMhd.js";import{r as Ke}from"./events.DQ172AOg.js";import{r as z}from"./core-util-is.Ca1qap10.js";import{r as J}from"./inherits.BICa84dG.js";import{r as Ne}from"./util.B7D3mE8i.js";import{r as fr}from"./util-deprecate.CbETmsYd.js";import{r as qe}from"./string_decoder.Bvf-nAzU.js";import{r as or}from"./create-hmac.ErTzv0Lu.js";import{r as sr}from"./browserify-rsa.zGaK9nYx.js";import{r as Ve}from"./elliptic.bqhJRvLL.js";import{r as Ge}from"./bn.js.D0kDLt-Z.js";import{r as Xe}from"./parse-asn1.cvUmqw_C.js";const ur={sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},lr={sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},dr={sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},hr={sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},cr={sign:"ecdsa",hash:"sha256",id:""},pr={sign:"ecdsa",hash:"sha224",id:""},gr={sign:"ecdsa",hash:"sha384",id:""},vr={sign:"ecdsa",hash:"sha512",id:""},wr={sign:"dsa",hash:"sha1",id:""},br={sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},yr={sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},Je={sha224WithRSAEncryption:ur,"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:lr,"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:dr,"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:hr,"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:cr,sha224:pr,sha384:gr,sha512:vr,"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:wr,"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:br,"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:yr,"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}};var pe,Be;function Fr(){return Be||(Be=1,pe=Je),pe}var te={exports:{}},ge,We;function Qe(){return We||(We=1,ge=Ke().EventEmitter),ge}var ie={exports:{}},De;function xe(){return De||(De=1,function(h,y){var M=nr,p=M.Buffer;function A(s,l){for(var d in s)l[d]=s[d]}p.from&&p.alloc&&p.allocUnsafe&&p.allocUnsafeSlow?h.exports=M:(A(M,y),y.Buffer=v);function v(s,l,d){return p(s,l,d)}A(p,v),v.from=function(s,l,d){if(typeof s=="number")throw new TypeError("Argument must not be a number");return p(s,l,d)},v.alloc=function(s,l,d){if(typeof s!="number")throw new TypeError("Argument must be a number");var c=p(s);return l!==void 0?typeof d=="string"?c.fill(l,d):c.fill(l):c.fill(0),c},v.allocUnsafe=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return p(s)},v.allocUnsafeSlow=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return M.SlowBuffer(s)}}(ie,ie.exports)),ie.exports}var ve={exports:{}},je;function mr(){return je||(je=1,function(h){function y(v,s){if(!(v instanceof s))throw new TypeError("Cannot call a class as a function")}var M=xe().Buffer,p=Ne();function A(v,s,l){v.copy(s,l)}h.exports=function(){function v(){y(this,v),this.head=null,this.tail=null,this.length=0}return v.prototype.push=function(l){var d={data:l,next:null};this.length>0?this.tail.next=d:this.head=d,this.tail=d,++this.length},v.prototype.unshift=function(l){var d={data:l,next:this.head};this.length===0&&(this.tail=d),this.head=d,++this.length},v.prototype.shift=function(){if(this.length!==0){var l=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,l}},v.prototype.clear=function(){this.head=this.tail=null,this.length=0},v.prototype.join=function(l){if(this.length===0)return"";for(var d=this.head,c=""+d.data;d=d.next;)c+=l+d.data;return c},v.prototype.concat=function(l){if(this.length===0)return M.alloc(0);for(var d=M.allocUnsafe(l>>>0),c=this.head,S=0;c;)A(c.data,d,S),S+=c.data.length,c=c.next;return d},v}(),p&&p.inspect&&p.inspect.custom&&(h.exports.prototype[p.inspect.custom]=function(){var v=p.inspect({length:this.length});return this.constructor.name+" "+v})}(ve)),ve.exports}var we,Te;function Ye(){if(Te)return we;Te=1;var h=fe();function y(A,v){var s=this,l=this._readableState&&this._readableState.destroyed,d=this._writableState&&this._writableState.destroyed;return l||d?(v?v(A):A&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,h.nextTick(p,this,A)):h.nextTick(p,this,A)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(A||null,function(c){!v&&c?s._writableState?s._writableState.errorEmitted||(s._writableState.errorEmitted=!0,h.nextTick(p,s,c)):h.nextTick(p,s,c):v&&v(c)}),this)}function M(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function p(A,v){A.emit("error",v)}return we={destroy:y,undestroy:M},we}var be,Ce;function Ze(){if(Ce)return be;Ce=1;var h=fe();be=E;function y(t){var i=this;this.next=null,this.entry=null,this.finish=function(){se(i,t)}}var M=!ne.browser&&["v0.10","v0.9."].indexOf(ne.version.slice(0,5))>-1?setImmediate:h.nextTick,p;E.WritableState=R;var A=Object.create(z());A.inherits=J();var v={deprecate:fr()},s=Qe(),l=xe().Buffer,d=(typeof ae<"u"?ae:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function c(t){return l.from(t)}function S(t){return l.isBuffer(t)||t instanceof d}var n=Ye();A.inherits(E,s);function w(){}function R(t,i){p=p||X(),t=t||{};var o=i instanceof p;this.objectMode=!!t.objectMode,o&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var m=t.highWaterMark,B=t.writableHighWaterMark,D=this.objectMode?16:16*1024;m||m===0?this.highWaterMark=m:o&&(B||B===0)?this.highWaterMark=B:this.highWaterMark=D,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var U=t.decodeStrings===!1;this.decodeStrings=!U,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(I){O(i,I)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new y(this)}R.prototype.getBuffer=function(){for(var i=this.bufferedRequest,o=[];i;)o.push(i),i=i.next;return o},function(){try{Object.defineProperty(R.prototype,"buffer",{get:v.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var q;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(q=Function.prototype[Symbol.hasInstance],Object.defineProperty(E,Symbol.hasInstance,{value:function(t){return q.call(this,t)?!0:this!==E?!1:t&&t._writableState instanceof R}})):q=function(t){return t instanceof this};function E(t){if(p=p||X(),!q.call(E,this)&&!(this instanceof p))return new E(t);this._writableState=new R(t,this),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),s.call(this)}E.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function C(t,i){var o=new Error("write after end");t.emit("error",o),h.nextTick(i,o)}function g(t,i,o,m){var B=!0,D=!1;return o===null?D=new TypeError("May not write null values to stream"):typeof o!="string"&&o!==void 0&&!i.objectMode&&(D=new TypeError("Invalid non-string/buffer chunk")),D&&(t.emit("error",D),h.nextTick(m,D),B=!1),B}E.prototype.write=function(t,i,o){var m=this._writableState,B=!1,D=!m.objectMode&&S(t);return D&&!l.isBuffer(t)&&(t=c(t)),typeof i=="function"&&(o=i,i=null),D?i="buffer":i||(i=m.defaultEncoding),typeof o!="function"&&(o=w),m.ended?C(this,o):(D||g(this,m,t,o))&&(m.pendingcb++,B=x(this,m,D,t,i,o)),B},E.prototype.cork=function(){var t=this._writableState;t.corked++},E.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&F(this,t))},E.prototype.setDefaultEncoding=function(i){if(typeof i=="string"&&(i=i.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((i+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+i);return this._writableState.defaultEncoding=i,this};function f(t,i,o){return!t.objectMode&&t.decodeStrings!==!1&&typeof i=="string"&&(i=l.from(i,o)),i}Object.defineProperty(E.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function x(t,i,o,m,B,D){if(!o){var U=f(i,m,B);m!==U&&(o=!0,B="buffer",m=U)}var I=i.objectMode?1:m.length;i.length+=I;var K=i.length<i.highWaterMark;if(K||(i.needDrain=!0),i.writing||i.corked){var N=i.lastBufferedRequest;i.lastBufferedRequest={chunk:m,encoding:B,isBuf:o,callback:D,next:null},N?N.next=i.lastBufferedRequest:i.bufferedRequest=i.lastBufferedRequest,i.bufferedRequestCount+=1}else b(t,i,!1,I,m,B,D);return K}function b(t,i,o,m,B,D,U){i.writelen=m,i.writecb=U,i.writing=!0,i.sync=!0,o?t._writev(B,i.onwrite):t._write(B,D,i.onwrite),i.sync=!1}function L(t,i,o,m,B){--i.pendingcb,o?(h.nextTick(B,m),h.nextTick($,t,i),t._writableState.errorEmitted=!0,t.emit("error",m)):(B(m),t._writableState.errorEmitted=!0,t.emit("error",m),$(t,i))}function T(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function O(t,i){var o=t._writableState,m=o.sync,B=o.writecb;if(T(o),i)L(t,o,m,i,B);else{var D=P(o);!D&&!o.corked&&!o.bufferProcessing&&o.bufferedRequest&&F(t,o),m?M(j,t,o,D,B):j(t,o,D,B)}}function j(t,i,o,m){o||H(t,i),i.pendingcb--,m(),$(t,i)}function H(t,i){i.length===0&&i.needDrain&&(i.needDrain=!1,t.emit("drain"))}function F(t,i){i.bufferProcessing=!0;var o=i.bufferedRequest;if(t._writev&&o&&o.next){var m=i.bufferedRequestCount,B=new Array(m),D=i.corkedRequestsFree;D.entry=o;for(var U=0,I=!0;o;)B[U]=o,o.isBuf||(I=!1),o=o.next,U+=1;B.allBuffers=I,b(t,i,!0,i.length,B,"",D.finish),i.pendingcb++,i.lastBufferedRequest=null,D.next?(i.corkedRequestsFree=D.next,D.next=null):i.corkedRequestsFree=new y(i),i.bufferedRequestCount=0}else{for(;o;){var K=o.chunk,N=o.encoding,e=o.callback,r=i.objectMode?1:K.length;if(b(t,i,!1,r,K,N,e),o=o.next,i.bufferedRequestCount--,i.writing)break}o===null&&(i.lastBufferedRequest=null)}i.bufferedRequest=o,i.bufferProcessing=!1}E.prototype._write=function(t,i,o){o(new Error("_write() is not implemented"))},E.prototype._writev=null,E.prototype.end=function(t,i,o){var m=this._writableState;typeof t=="function"?(o=t,t=null,i=null):typeof i=="function"&&(o=i,i=null),t!=null&&this.write(t,i),m.corked&&(m.corked=1,this.uncork()),m.ending||oe(this,m,o)};function P(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function V(t,i){t._final(function(o){i.pendingcb--,o&&t.emit("error",o),i.prefinished=!0,t.emit("prefinish"),$(t,i)})}function ee(t,i){!i.prefinished&&!i.finalCalled&&(typeof t._final=="function"?(i.pendingcb++,i.finalCalled=!0,h.nextTick(V,t,i)):(i.prefinished=!0,t.emit("prefinish")))}function $(t,i){var o=P(i);return o&&(ee(t,i),i.pendingcb===0&&(i.finished=!0,t.emit("finish"))),o}function oe(t,i,o){i.ending=!0,$(t,i),o&&(i.finished?h.nextTick(o):t.once("finish",o)),i.ended=!0,t.writable=!1}function se(t,i,o){var m=t.entry;for(t.entry=null;m;){var B=m.callback;i.pendingcb--,B(o),m=m.next}i.corkedRequestsFree.next=t}return Object.defineProperty(E.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),E.prototype.destroy=n.destroy,E.prototype._undestroy=n.undestroy,E.prototype._destroy=function(t,i){this.end(),i(t)},be}var ye,He;function X(){if(He)return ye;He=1;var h=fe(),y=Object.keys||function(n){var w=[];for(var R in n)w.push(R);return w};ye=d;var M=Object.create(z());M.inherits=J();var p=ze(),A=Ze();M.inherits(d,p);for(var v=y(A.prototype),s=0;s<v.length;s++){var l=v[s];d.prototype[l]||(d.prototype[l]=A.prototype[l])}function d(n){if(!(this instanceof d))return new d(n);p.call(this,n),A.call(this,n),n&&n.readable===!1&&(this.readable=!1),n&&n.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,n&&n.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",c)}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function c(){this.allowHalfOpen||this._writableState.ended||h.nextTick(S,this)}function S(n){n.end()}return Object.defineProperty(d.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(n){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=n,this._writableState.destroyed=n)}}),d.prototype._destroy=function(n,w){this.push(null),this.end(),h.nextTick(w,n)},ye}var me,Le;function ze(){if(Le)return me;Le=1;var h=fe();me=f;var y=ar(),M;f.ReadableState=g,Ke().EventEmitter;var p=function(e,r){return e.listeners(r).length},A=Qe(),v=xe().Buffer,s=(typeof ae<"u"?ae:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function l(e){return v.from(e)}function d(e){return v.isBuffer(e)||e instanceof s}var c=Object.create(z());c.inherits=J();var S=Ne(),n=void 0;S&&S.debuglog?n=S.debuglog("stream"):n=function(){};var w=mr(),R=Ye(),q;c.inherits(f,A);var E=["error","close","destroy","pause","resume"];function C(e,r,a){if(typeof e.prependListener=="function")return e.prependListener(r,a);!e._events||!e._events[r]?e.on(r,a):y(e._events[r])?e._events[r].unshift(a):e._events[r]=[a,e._events[r]]}function g(e,r){M=M||X(),e=e||{};var a=r instanceof M;this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var u=e.highWaterMark,W=e.readableHighWaterMark,_=this.objectMode?16:16*1024;u||u===0?this.highWaterMark=u:a&&(W||W===0)?this.highWaterMark=W:this.highWaterMark=_,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new w,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(q||(q=qe().StringDecoder),this.decoder=new q(e.encoding),this.encoding=e.encoding)}function f(e){if(M=M||X(),!(this instanceof f))return new f(e);this._readableState=new g(e,this),this.readable=!0,e&&(typeof e.read=="function"&&(this._read=e.read),typeof e.destroy=="function"&&(this._destroy=e.destroy)),A.call(this)}Object.defineProperty(f.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),f.prototype.destroy=R.destroy,f.prototype._undestroy=R.undestroy,f.prototype._destroy=function(e,r){this.push(null),r(e)},f.prototype.push=function(e,r){var a=this._readableState,u;return a.objectMode?u=!0:typeof e=="string"&&(r=r||a.defaultEncoding,r!==a.encoding&&(e=v.from(e,r),r=""),u=!0),x(this,e,r,!1,u)},f.prototype.unshift=function(e){return x(this,e,null,!0,!1)};function x(e,r,a,u,W){var _=e._readableState;if(r===null)_.reading=!1,F(e,_);else{var k;W||(k=L(_,r)),k?e.emit("error",k):_.objectMode||r&&r.length>0?(typeof r!="string"&&!_.objectMode&&Object.getPrototypeOf(r)!==v.prototype&&(r=l(r)),u?_.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):b(e,_,r,!0):_.ended?e.emit("error",new Error("stream.push() after EOF")):(_.reading=!1,_.decoder&&!a?(r=_.decoder.write(r),_.objectMode||r.length!==0?b(e,_,r,!1):ee(e,_)):b(e,_,r,!1))):u||(_.reading=!1)}return T(_)}function b(e,r,a,u){r.flowing&&r.length===0&&!r.sync?(e.emit("data",a),e.read(0)):(r.length+=r.objectMode?1:a.length,u?r.buffer.unshift(a):r.buffer.push(a),r.needReadable&&P(e)),ee(e,r)}function L(e,r){var a;return!d(r)&&typeof r!="string"&&r!==void 0&&!e.objectMode&&(a=new TypeError("Invalid non-string/buffer chunk")),a}function T(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||e.length===0)}f.prototype.isPaused=function(){return this._readableState.flowing===!1},f.prototype.setEncoding=function(e){return q||(q=qe().StringDecoder),this._readableState.decoder=new q(e),this._readableState.encoding=e,this};var O=8388608;function j(e){return e>=O?e=O:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function H(e,r){return e<=0||r.length===0&&r.ended?0:r.objectMode?1:e!==e?r.flowing&&r.length?r.buffer.head.data.length:r.length:(e>r.highWaterMark&&(r.highWaterMark=j(e)),e<=r.length?e:r.ended?r.length:(r.needReadable=!0,0))}f.prototype.read=function(e){n("read",e),e=parseInt(e,10);var r=this._readableState,a=e;if(e!==0&&(r.emittedReadable=!1),e===0&&r.needReadable&&(r.length>=r.highWaterMark||r.ended))return n("read: emitReadable",r.length,r.ended),r.length===0&&r.ended?I(this):P(this),null;if(e=H(e,r),e===0&&r.ended)return r.length===0&&I(this),null;var u=r.needReadable;n("need readable",u),(r.length===0||r.length-e<r.highWaterMark)&&(u=!0,n("length less than watermark",u)),r.ended||r.reading?(u=!1,n("reading or ended",u)):u&&(n("do read"),r.reading=!0,r.sync=!0,r.length===0&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,r.reading||(e=H(a,r)));var W;return e>0?W=m(e,r):W=null,W===null?(r.needReadable=!0,e=0):r.length-=e,r.length===0&&(r.ended||(r.needReadable=!0),a!==e&&r.ended&&I(this)),W!==null&&this.emit("data",W),W};function F(e,r){if(!r.ended){if(r.decoder){var a=r.decoder.end();a&&a.length&&(r.buffer.push(a),r.length+=r.objectMode?1:a.length)}r.ended=!0,P(e)}}function P(e){var r=e._readableState;r.needReadable=!1,r.emittedReadable||(n("emitReadable",r.flowing),r.emittedReadable=!0,r.sync?h.nextTick(V,e):V(e))}function V(e){n("emit readable"),e.emit("readable"),o(e)}function ee(e,r){r.readingMore||(r.readingMore=!0,h.nextTick($,e,r))}function $(e,r){for(var a=r.length;!r.reading&&!r.flowing&&!r.ended&&r.length<r.highWaterMark&&(n("maybeReadMore read 0"),e.read(0),a!==r.length);)a=r.length;r.readingMore=!1}f.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},f.prototype.pipe=function(e,r){var a=this,u=this._readableState;switch(u.pipesCount){case 0:u.pipes=e;break;case 1:u.pipes=[u.pipes,e];break;default:u.pipes.push(e);break}u.pipesCount+=1,n("pipe count=%d opts=%j",u.pipesCount,r);var W=(!r||r.end!==!1)&&e!==ne.stdout&&e!==ne.stderr,_=W?re:Q;u.endEmitted?h.nextTick(_):a.once("end",_),e.on("unpipe",k);function k(G,Y){n("onunpipe"),G===a&&Y&&Y.hasUnpiped===!1&&(Y.hasUnpiped=!0,tr())}function re(){n("onend"),e.end()}var ue=oe(a);e.on("drain",ue);var Ae=!1;function tr(){n("cleanup"),e.removeListener("close",he),e.removeListener("finish",ce),e.removeListener("drain",ue),e.removeListener("error",de),e.removeListener("unpipe",k),a.removeListener("end",re),a.removeListener("end",Q),a.removeListener("data",ke),Ae=!0,u.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&ue()}var le=!1;a.on("data",ke);function ke(G){n("ondata"),le=!1;var Y=e.write(G);Y===!1&&!le&&((u.pipesCount===1&&u.pipes===e||u.pipesCount>1&&N(u.pipes,e)!==-1)&&!Ae&&(n("false write response, pause",u.awaitDrain),u.awaitDrain++,le=!0),a.pause())}function de(G){n("onerror",G),Q(),e.removeListener("error",de),p(e,"error")===0&&e.emit("error",G)}C(e,"error",de);function he(){e.removeListener("finish",ce),Q()}e.once("close",he);function ce(){n("onfinish"),e.removeListener("close",he),Q()}e.once("finish",ce);function Q(){n("unpipe"),a.unpipe(e)}return e.emit("pipe",a),u.flowing||(n("pipe resume"),a.resume()),e};function oe(e){return function(){var r=e._readableState;n("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&p(e,"data")&&(r.flowing=!0,o(e))}}f.prototype.unpipe=function(e){var r=this._readableState,a={hasUnpiped:!1};if(r.pipesCount===0)return this;if(r.pipesCount===1)return e&&e!==r.pipes?this:(e||(e=r.pipes),r.pipes=null,r.pipesCount=0,r.flowing=!1,e&&e.emit("unpipe",this,a),this);if(!e){var u=r.pipes,W=r.pipesCount;r.pipes=null,r.pipesCount=0,r.flowing=!1;for(var _=0;_<W;_++)u[_].emit("unpipe",this,{hasUnpiped:!1});return this}var k=N(r.pipes,e);return k===-1?this:(r.pipes.splice(k,1),r.pipesCount-=1,r.pipesCount===1&&(r.pipes=r.pipes[0]),e.emit("unpipe",this,a),this)},f.prototype.on=function(e,r){var a=A.prototype.on.call(this,e,r);if(e==="data")this._readableState.flowing!==!1&&this.resume();else if(e==="readable"){var u=this._readableState;!u.endEmitted&&!u.readableListening&&(u.readableListening=u.needReadable=!0,u.emittedReadable=!1,u.reading?u.length&&P(this):h.nextTick(se,this))}return a},f.prototype.addListener=f.prototype.on;function se(e){n("readable nexttick read 0"),e.read(0)}f.prototype.resume=function(){var e=this._readableState;return e.flowing||(n("resume"),e.flowing=!0,t(this,e)),this};function t(e,r){r.resumeScheduled||(r.resumeScheduled=!0,h.nextTick(i,e,r))}function i(e,r){r.reading||(n("resume read 0"),e.read(0)),r.resumeScheduled=!1,r.awaitDrain=0,e.emit("resume"),o(e),r.flowing&&!r.reading&&e.read(0)}f.prototype.pause=function(){return n("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(n("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function o(e){var r=e._readableState;for(n("flow",r.flowing);r.flowing&&e.read()!==null;);}f.prototype.wrap=function(e){var r=this,a=this._readableState,u=!1;e.on("end",function(){if(n("wrapped end"),a.decoder&&!a.ended){var k=a.decoder.end();k&&k.length&&r.push(k)}r.push(null)}),e.on("data",function(k){if(n("wrapped data"),a.decoder&&(k=a.decoder.write(k)),!(a.objectMode&&k==null)&&!(!a.objectMode&&(!k||!k.length))){var re=r.push(k);re||(u=!0,e.pause())}});for(var W in e)this[W]===void 0&&typeof e[W]=="function"&&(this[W]=function(k){return function(){return e[k].apply(e,arguments)}}(W));for(var _=0;_<E.length;_++)e.on(E[_],this.emit.bind(this,E[_]));return this._read=function(k){n("wrapped _read",k),u&&(u=!1,e.resume())},this},Object.defineProperty(f.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),f._fromList=m;function m(e,r){if(r.length===0)return null;var a;return r.objectMode?a=r.buffer.shift():!e||e>=r.length?(r.decoder?a=r.buffer.join(""):r.buffer.length===1?a=r.buffer.head.data:a=r.buffer.concat(r.length),r.buffer.clear()):a=B(e,r.buffer,r.decoder),a}function B(e,r,a){var u;return e<r.head.data.length?(u=r.head.data.slice(0,e),r.head.data=r.head.data.slice(e)):e===r.head.data.length?u=r.shift():u=a?D(e,r):U(e,r),u}function D(e,r){var a=r.head,u=1,W=a.data;for(e-=W.length;a=a.next;){var _=a.data,k=e>_.length?_.length:e;if(k===_.length?W+=_:W+=_.slice(0,e),e-=k,e===0){k===_.length?(++u,a.next?r.head=a.next:r.head=r.tail=null):(r.head=a,a.data=_.slice(k));break}++u}return r.length-=u,W}function U(e,r){var a=v.allocUnsafe(e),u=r.head,W=1;for(u.data.copy(a),e-=u.data.length;u=u.next;){var _=u.data,k=e>_.length?_.length:e;if(_.copy(a,a.length-e,0,k),e-=k,e===0){k===_.length?(++W,u.next?r.head=u.next:r.head=r.tail=null):(r.head=u,u.data=_.slice(k));break}++W}return r.length-=W,a}function I(e){var r=e._readableState;if(r.length>0)throw new Error('"endReadable()" called on non-empty stream');r.endEmitted||(r.ended=!0,h.nextTick(K,r,e))}function K(e,r){!e.endEmitted&&e.length===0&&(e.endEmitted=!0,r.readable=!1,r.emit("end"))}function N(e,r){for(var a=0,u=e.length;a<u;a++)if(e[a]===r)return a;return-1}return me}var _e,Pe;function er(){if(Pe)return _e;Pe=1,_e=p;var h=X(),y=Object.create(z());y.inherits=J(),y.inherits(p,h);function M(s,l){var d=this._transformState;d.transforming=!1;var c=d.writecb;if(!c)return this.emit("error",new Error("write callback called multiple times"));d.writechunk=null,d.writecb=null,l!=null&&this.push(l),c(s);var S=this._readableState;S.reading=!1,(S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}function p(s){if(!(this instanceof p))return new p(s);h.call(this,s),this._transformState={afterTransform:M.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,s&&(typeof s.transform=="function"&&(this._transform=s.transform),typeof s.flush=="function"&&(this._flush=s.flush)),this.on("prefinish",A)}function A(){var s=this;typeof this._flush=="function"?this._flush(function(l,d){v(s,l,d)}):v(this,null,null)}p.prototype.push=function(s,l){return this._transformState.needTransform=!1,h.prototype.push.call(this,s,l)},p.prototype._transform=function(s,l,d){throw new Error("_transform() is not implemented")},p.prototype._write=function(s,l,d){var c=this._transformState;if(c.writecb=d,c.writechunk=s,c.writeencoding=l,!c.transforming){var S=this._readableState;(c.needTransform||S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}},p.prototype._read=function(s){var l=this._transformState;l.writechunk!==null&&l.writecb&&!l.transforming?(l.transforming=!0,this._transform(l.writechunk,l.writeencoding,l.afterTransform)):l.needTransform=!0},p.prototype._destroy=function(s,l){var d=this;h.prototype._destroy.call(this,s,function(c){l(c),d.emit("close")})};function v(s,l,d){if(l)return s.emit("error",l);if(d!=null&&s.push(d),s._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(s._transformState.transforming)throw new Error("Calling transform done when still transforming");return s.push(null)}return _e}var Se,Oe;function _r(){if(Oe)return Se;Oe=1,Se=M;var h=er(),y=Object.create(z());y.inherits=J(),y.inherits(M,h);function M(p){if(!(this instanceof M))return new M(p);h.call(this,p)}return M.prototype._transform=function(p,A,v){v(null,p)},Se}var Ue;function Sr(){return Ue||(Ue=1,function(h,y){y=h.exports=ze(),y.Stream=y,y.Readable=y,y.Writable=Ze(),y.Duplex=X(),y.Transform=er(),y.PassThrough=_r()}(te,te.exports)),te.exports}var Z={exports:{}};const rr={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"};var Ie;function Rr(){if(Ie)return Z.exports;Ie=1;var h=Me().Buffer,y=or(),M=sr(),p=Ve().ec,A=Ge(),v=Xe(),s=rr,l=1;function d(g,f,x,b,L){var T=v(f);if(T.curve){if(b!=="ecdsa"&&b!=="ecdsa/rsa")throw new Error("wrong private key type");return c(g,T)}else if(T.type==="dsa"){if(b!=="dsa")throw new Error("wrong private key type");return S(g,T,x)}if(b!=="rsa"&&b!=="ecdsa/rsa")throw new Error("wrong private key type");if(f.padding!==void 0&&f.padding!==l)throw new Error("illegal or unsupported padding mode");g=h.concat([L,g]);for(var O=T.modulus.byteLength(),j=[0,1];g.length+j.length+1<O;)j.push(255);j.push(0);for(var H=-1;++H<g.length;)j.push(g[H]);var F=M(j,T);return F}function c(g,f){var x=s[f.curve.join(".")];if(!x)throw new Error("unknown curve "+f.curve.join("."));var b=new p(x),L=b.keyFromPrivate(f.privateKey),T=L.sign(g);return h.from(T.toDER())}function S(g,f,x){for(var b=f.params.priv_key,L=f.params.p,T=f.params.q,O=f.params.g,j=new A(0),H,F=R(g,T).mod(T),P=!1,V=w(b,T,g,x);P===!1;)H=E(T,V,x),j=C(O,H,L,T),P=H.invm(T).imul(F.add(b.mul(j))).mod(T),P.cmpn(0)===0&&(P=!1,j=new A(0));return n(j,P)}function n(g,f){g=g.toArray(),f=f.toArray(),g[0]&128&&(g=[0].concat(g)),f[0]&128&&(f=[0].concat(f));var x=g.length+f.length+4,b=[48,x,2,g.length];return b=b.concat(g,[2,f.length],f),h.from(b)}function w(g,f,x,b){if(g=h.from(g.toArray()),g.length<f.byteLength()){var L=h.alloc(f.byteLength()-g.length);g=h.concat([L,g])}var T=x.length,O=q(x,f),j=h.alloc(T);j.fill(1);var H=h.alloc(T);return H=y(b,H).update(j).update(h.from([0])).update(g).update(O).digest(),j=y(b,H).update(j).digest(),H=y(b,H).update(j).update(h.from([1])).update(g).update(O).digest(),j=y(b,H).update(j).digest(),{k:H,v:j}}function R(g,f){var x=new A(g),b=(g.length<<3)-f.bitLength();return b>0&&x.ishrn(b),x}function q(g,f){g=R(g,f),g=g.mod(f);var x=h.from(g.toArray());if(x.length<f.byteLength()){var b=h.alloc(f.byteLength()-x.length);x=h.concat([b,x])}return x}function E(g,f,x){var b,L;do{for(b=h.alloc(0);b.length*8<g.bitLength();)f.v=y(x,f.k).update(f.v).digest(),b=h.concat([b,f.v]);L=R(b,g),f.k=y(x,f.k).update(f.v).update(h.from([0])).digest(),f.v=y(x,f.k).update(f.v).digest()}while(L.cmp(g)!==-1);return L}function C(g,f,x,b){return g.toRed(A.mont(x)).redPow(f).fromRed().mod(b)}return Z.exports=d,Z.exports.getKey=w,Z.exports.makeKey=E,Z.exports}var Re,Fe;function Er(){if(Fe)return Re;Fe=1;var h=Me().Buffer,y=Ge(),M=Ve().ec,p=Xe(),A=rr;function v(c,S,n,w,R){var q=p(n);if(q.type==="ec"){if(w!=="ecdsa"&&w!=="ecdsa/rsa")throw new Error("wrong public key type");return s(c,S,q)}else if(q.type==="dsa"){if(w!=="dsa")throw new Error("wrong public key type");return l(c,S,q)}if(w!=="rsa"&&w!=="ecdsa/rsa")throw new Error("wrong public key type");S=h.concat([R,S]);for(var E=q.modulus.byteLength(),C=[1],g=0;S.length+C.length+2<E;)C.push(255),g+=1;C.push(0);for(var f=-1;++f<S.length;)C.push(S[f]);C=h.from(C);var x=y.mont(q.modulus);c=new y(c).toRed(x),c=c.redPow(new y(q.publicExponent)),c=h.from(c.fromRed().toArray());var b=g<8?1:0;for(E=Math.min(c.length,C.length),c.length!==C.length&&(b=1),f=-1;++f<E;)b|=c[f]^C[f];return b===0}function s(c,S,n){var w=A[n.data.algorithm.curve.join(".")];if(!w)throw new Error("unknown curve "+n.data.algorithm.curve.join("."));var R=new M(w),q=n.data.subjectPrivateKey.data;return R.verify(S,c,q)}function l(c,S,n){var w=n.data.p,R=n.data.q,q=n.data.g,E=n.data.pub_key,C=p.signature.decode(c,"der"),g=C.s,f=C.r;d(g,R),d(f,R);var x=y.mont(w),b=g.invm(R),L=q.toRed(x).redPow(new y(S).mul(b).mod(R)).fromRed().mul(E.toRed(x).redPow(f.mul(b).mod(R)).fromRed()).mod(w).mod(R);return L.cmp(f)===0}function d(c,S){if(c.cmpn(0)<=0)throw new Error("invalid sig");if(c.cmp(S)>=0)throw new Error("invalid sig")}return Re=v,Re}var Ee,$e;function $r(){if($e)return Ee;$e=1;var h=Me().Buffer,y=ir(),M=Sr(),p=J(),A=Rr(),v=Er(),s=Je;Object.keys(s).forEach(function(n){s[n].id=h.from(s[n].id,"hex"),s[n.toLowerCase()]=s[n]});function l(n){M.Writable.call(this);var w=s[n];if(!w)throw new Error("Unknown message digest");this._hashType=w.hash,this._hash=y(w.hash),this._tag=w.id,this._signType=w.sign}p(l,M.Writable),l.prototype._write=function(w,R,q){this._hash.update(w),q()},l.prototype.update=function(w,R){return this._hash.update(typeof w=="string"?h.from(w,R):w),this},l.prototype.sign=function(w,R){this.end();var q=this._hash.digest(),E=A(q,w,this._hashType,this._signType,this._tag);return R?E.toString(R):E};function d(n){M.Writable.call(this);var w=s[n];if(!w)throw new Error("Unknown message digest");this._hash=y(w.hash),this._tag=w.id,this._signType=w.sign}p(d,M.Writable),d.prototype._write=function(w,R,q){this._hash.update(w),q()},d.prototype.update=function(w,R){return this._hash.update(typeof w=="string"?h.from(w,R):w),this},d.prototype.verify=function(w,R,q){var E=typeof R=="string"?h.from(R,q):R;this.end();var C=this._hash.digest();return v(E,C,w,this._signType,this._tag)};function c(n){return new l(n)}function S(n){return new d(n)}return Ee={Sign:c,Verify:S,createSign:c,createVerify:S},Ee}export{Fr as a,$r as r};
